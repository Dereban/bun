"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();System.register(["../modal","./render","../options","underscore","../util","../lang"],function(e,t){var n,r,o,a,i,c;t&&t.id;return{setters:[function(e){n=e},function(e){r=e},function(e){o=e},function(e){a=e},function(e){i=e},function(e){c=e}],execute:function(){var t=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,{id:"options-panel"}));return e.onClick({".tab_link":function(t){return e.switchTab(t)},"#export":function(){return e.exportConfigs()},"#import":function(t){return e.importConfigs(t)},"#hidden":function(){return e.clearHidden()}}),e.onAll("change",function(t){return e.applyChange(t)}),e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){this.el.innerHTML=r["default"](),this.assignValues(),this.$hidden=this.el.query("#hidden")}},{key:"assignValues",value:function(){for(var e in o.models){var t=o.models[e],n=this.el.query("#"+e),r=t.get();switch(t.spec.type){case 0:n.checked=r;break;case 1:case 4:n.value=r;break;case 3:n.value=String.fromCharCode(r).toUpperCase()}}}},{key:"applyChange",value:function(e){var t=e.target,n=t.getAttribute("id"),r=o.models[n],a=void 0;switch(r.spec.type){case 0:a=t.checked;break;case 1:a=parseInt(t.value);break;case 4:a=t.value;break;case 3:a=t.value.toUpperCase().charCodeAt(0)}r.validate(a)?o["default"].set(n,a):t.value=""}},{key:"switchTab",value:function(e){e.preventDefault();var t=e.target;a.each(this.el.children,function(e){return e.query(".tab_sel").classList.remove("tab_sel")}),t.classList.add("tab_sel"),a.find(this.el.lastChild.children,function(e){return e.classList.contains(t.getAttribute("data-content"))}).classList.add("tab_sel")}},{key:"exportConfigs",value:function(){var e=document.getElementById("export"),t=new Blob([JSON.stringify(localStorage)],{type:"octet/stream"});e.setAttribute("href",window.URL.createObjectURL(t)),e.setAttribute("download","meguca-config.json")}},{key:"importConfigs",value:function(e){e.preventDefault();var t=document.query("#importSettings");t.click(),i.onceAll(t,"change",function(){var e=new FileReader;e.readAsText(t.files[0]),e.onload=function(e){var t=void 0;try{t=JSON.parse(e.target.result)}catch(n){return void alert(c.opts.importConfig.corrupt)}localStorage.clear();for(var r in t)localStorage.setItem(r,t[r]);alert(c.opts.importConfig.done),location.reload()}})}},{key:"renderHidden",value:function(e){var t=this.$hidden;t.textContent=t.textContent.replace(/\d+$/,e.toString())}},{key:"clearHidden",value:function(){this.renderHidden(0)}}]),t}(n.BannerModal);e("default",t),function(){function e(){if(r)return void(t.style.opacity="1");t.style.opacity=(+t.style.opacity+(n?-.02:.02)).toString();var o=+t.style.opacity;(n&&0>=o||!n&&o>=1)&&(n=!n),requestAnimationFrame(e)}if(!localStorage.getItem("optionsSeen")){var t=document.query("#options");t.style.opacity="1";var n=!0,r=void 0;t.addEventListener("click",function(){r=!0,localStorage.setItem("optionsSeen","1")}),e()}}()}}});
//# sourceMappingURL=../maps/options/view.js.map
